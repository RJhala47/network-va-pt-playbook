# Network VA & PT Playbook

> **Purpose**: A practical, repeatable Network Vulnerability Assessment (VA) and Penetration Testing (PT) playbook you can use during real engagements.
>
> **Audience**: Network / Security Engineers, Pentesters, Blue-Teamers-in-training
>
> **Disclaimer**: Only test systems you own or have *explicit written authorization* to test.

---

## Table of Contents
1. Engagement Preparation
2. Scoping & Rules of Engagement (RoE)
3. Reconnaissance
4. Network Discovery & Mapping
5. Vulnerability Assessment
6. Exploitation (Penetration Testing)
7. Post-Exploitation
8. Lateral Movement
9. Privilege Escalation
10. Persistence (If Allowed)
11. Cleanup
12. Reporting
13. Final Checklist

---

## 1. Engagement Preparation

### Objectives
- Understand business risk
- Identify crown jewels
- Define success criteria

### Inputs Needed
- Written authorization
- Scope (IPs, ranges, domains)
- Testing window
- Contact & escalation path

---

## 2. Scoping & Rules of Engagement (RoE)

### Define
- **In-Scope Assets**
  - IP ranges
  - VLANs
  - Network devices
  - VPNs / Firewalls
- **Out-of-Scope Assets**
- **Allowed Techniques**
  - Credentialed scans?
  - Exploitation?
  - DoS testing?

### Checklist
- [ ] Signed authorization letter
- [ ] Scope documented
- [ ] RoE approved
- [ ] Emergency stop procedure defined

---

## 3. Reconnaissance

### Passive Recon (No Touch)
```bash
whois target.com
dig target.com any
nslookup target.com
```

### OSINT
- Shodan
- Censys
- Public ASN lookups

---

## 4. Network Discovery & Mapping

### Host Discovery
```bash
nmap -sn 10.0.0.0/24
```

### Port Scanning
```bash
nmap -sS -p- -T4 10.0.0.10
nmap -sU --top-ports 100 10.0.0.10
```

### Service & Version Detection
```bash
nmap -sV -sC 10.0.0.10
```

### OS Detection
```bash
nmap -O 10.0.0.10
```

### Network Diagram Notes
- Subnets
- Gateways
- Firewalls
- Trust boundaries

---

## 5. Vulnerability Assessment

### Automated Scanning

#### Nessus / OpenVAS
- Credentialed scan (preferred)
- Network-based scan

#### Nmap NSE Scripts
```bash
nmap --script vuln 10.0.0.10
```

### Manual Validation
- False positives
- Exploitability
- Business impact

### Common Network Vulns
- SMB signing disabled
- Weak SNMP communities
- Telnet enabled
- Outdated firmware

---

## 6. Exploitation (Penetration Testing)

### Exploit Selection
- Match service + version
- Prefer reliable exploits

### Metasploit Example
```bash
msfconsole
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 10.0.0.10
run
```

### Manual Exploits
```bash
python exploit.py 10.0.0.10
```

---

## 7. Post-Exploitation

### Enumeration
```bash
whoami
ipconfig /all
netstat -ano
```

### Credential Access
- Memory dumps
- Config files
- Registry

---

## 8. Lateral Movement

### Techniques
- Pass-the-Hash
- Pass-the-Ticket
- SMB / WinRM / RDP

```bash
crackmapexec smb 10.0.0.0/24 -u user -H hash
```

---

## 9. Privilege Escalation

### Linux
```bash
sudo -l
find / -perm -4000 2>/dev/null
```

### Windows
```powershell
whoami /priv
systeminfo
```

---

## 10. Persistence (If Allowed)

> ⚠️ Only with explicit permission

- Scheduled tasks
- Services
- SSH keys

---

## 11. Cleanup

### Remove
- Uploaded tools
- Backdoors
- Test accounts

### Verify
- System stability
- No lingering access

---

## 12. Reporting

### Executive Summary
- Overall risk posture
- Key findings

### Technical Findings
- Vulnerability
- Evidence
- Impact
- Recommendation

### Risk Rating
- Likelihood
- Impact
- Severity

---

## 13. Final Engagement Checklist

### Pre-Engagement
- [ ] Authorization received
- [ ] Scope confirmed
- [ ] RoE signed

### Assessment
- [ ] Network mapped
- [ ] Vulnerabilities identified
- [ ] Exploits validated

### Post-Engagement
- [ ] Cleanup completed
- [ ] Report delivered
- [ ] Debrief conducted

---

## Appendix

### Handy Command Cheat Sheet
```bash
# Quick scan
nmap -T4 -A target

# SMB check
enum4linux target

# SNMP
snmpwalk -v2c -c public target
```

---

**Author**: Your Name  
**Version**: 1.0  
**Last Updated**: YYYY-MM-DD

